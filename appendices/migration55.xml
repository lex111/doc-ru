<?xml version="1.0" encoding="utf-8"?>
<!-- EN-Revision: 0d77f05f4541d8a977ebe4f96965dec4e10d6b33 Maintainer: rjhdby Status: ready -->
<!-- Reviewed: yes Maintainer: lex -->
<!-- $Revision$ -->
<!-- Based on UPGRADING version 322438. Work in progress !-->

<appendix xml:id="migration55" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>Миграция с PHP 5.4.x на PHP 5.5.x</title>
 <simpara>
  &manual.migration.seealso;
  <link linkend="migration5">5.0.x</link>,
  <link linkend="migration51">5.1.x</link>,
  <link linkend="migration52">5.2.x</link>,
  <link linkend="migration53">5.3.x</link>,
  <link linkend="migration54">5.4.x</link>,
  <link linkend="migration56">5.6.x</link> и
  <link linkend="migration70">7.0.x</link>.
 </simpara>
 
 <sect1 xml:id="migration55.changes">
  <title>Что поменялось в PHP 5.5.x</title>
  <simpara>
   Большинство изменений в PHP 5.5.x никак не повлияет на
   существющий код.  Есть 
   <link linkend="migration55.incompatible">несколько несовместимостей</link>
   и <link linkend="migration55.new-features">новых возможностей</link>, на которые надо обратить внимание.
   Также, перед миграцией в промышленных средах, 
   необходимо сперва протестировать код.
  </simpara>
  <simpara>
   Для систем, обновляющихся с более старых версий PHP, существуюет соответствующая документация:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="migration54">Замечания по обновлению для PHP 5.4.x</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration53">Замечания по обновлению для PHP 5.3.x</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration52">Замечания по обновлению для PHP 5.2.x</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration51">Замечания по обновлению для PHP 5.1.x</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration5">Переход с PHP 4 на PHP 5</link>.
    </simpara>
   </listitem>
  </itemizedlist>
 </sect1>
 
 <sect1 xml:id="migration55.incompatible">
  <title>Изменения, ломающие обратную совместимость</title>
  <simpara>
   Несмотря на то, что практически весь существующий код 
   не заметит перехода, всё же следует обратить внимание 
   на некоторые изменения, ломающие обратную совместимость:
  </simpara>
  
  <sect2 xml:id="migration55.incompatible.windows">
   <title>Прекращена поддержка Windows XP и 2003</title>
   
   <para>
    Прекращена поддержка Windows XP и 2003. Сборки под
    Windows теперь требуют минимум Windows Vista.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.incompatible.case">
   <title>Регистронезависимость теперь не является зависимой от локали</title>
   
   <para>
    Все регистронезависимые сравнения для функций, классов
    и имён констант теперь реализованы независимым от 
    локали образом в соответствии с правилами ASCII.
    Это улучшает поддержку языков, использующих
    латинский алфавит с необычными правилами сравнения,
    например, турецкий и азербайджанский.
   </para>
   <para>
    Это изменение может вызвать проблемы в коде, использующим
    регистронезависимое сравнение для не ASCII символов
    в многобайтовых кодировках (включая UTF-8), такие как
    акцентированные символы во многих европейских языках.
    Если у вас в кодовой базе используются не английские, не
    ASCII-символы, обратите особое внимание на это изменение
    перед миграцией промышленных сред на PHP 5.5.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.incompatible.pack">
   <title>Изменения <function>pack</function> и <function>unpack</function></title>
   
   <para>
    Функции <function>pack</function> и
    <function>unpack</function> были изменены так, чтобы
    они стали более совместимы с Perl:
   </para>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>pack</function> теперь поддерживает код
      форматирования "Z", который ведёт себя аналогично "a".
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>unpack</function> теперь поддерживает код
      форматирования "Z" для строк, дополненных NULL и ведёт
      себя так, как ранее вела при использовании "a": обрезает
      NULL-байты в конце строки.
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>unpack</function> теперь сохраняет NULL-байты
      в конце строки при использовании кода формата "a".
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>unpack</function> теперь обрезает все 
      пробельные символы ASCII при использовании кода
      формата "A".
     </simpara>
    </listitem>
   </itemizedlist>
   
   <para>
    Написание обратно совместимого кода, использующего
    код формата "a" в функции <function>unpack</function>,
    потребует использования функции
    <function>version_compare</function>, иначе обратная 
    совместимость поломается.
   </para>
   <para>
    Пример:
   </para>
   <informalexample>
    <programlisting role="php">
<![CDATA[
<?php
// Старый код:
$data = unpack('a5', $packed);

// Новый код:
if (version_compare(PHP_VERSION, '5.5.0-dev', '>=')) {
  $data = unpack('Z5', $packed);
} else {
  $data = unpack('a5', $packed);
}
?>
]]>
    </programlisting>
   </informalexample>
  </sect2>
  <sect2 xml:id="migration55.incompatible.json">
   <title><function>json_encode</function> changes</title>
   <para>
    Когда параметр <parameter>value</parameter>, переданный в <function>json_encode</function>, вызывает ошибку кодирования JSON, возвращается 
    &false; вместо частичного вывода, если <parameter>options</parameter> не содержит <constant>JSON_PARTIAL_OUTPUT_ON_ERROR</constant>.
    Смотрите <function>json_last_error</function> для полного списка причин, которые могут привести к сбою кодировки JSON.
    Одна из возможных причин сбоя заключается в том, что <parameter>value</parameter> содержит строки, содержащие некорректный UTF-8.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.incompatible.self-parent-static">
   <title><literal>self</literal>, <literal>parent</literal> и <literal>static</literal> теперь всегда регистронезависимы</title>
   
   <para>
    До PHP 5.5 были случаи, когда ключевые слова
    <link linkend="language.oop5.paamayim-nekudotayim">self</link>,
    <link linkend="language.oop5.paamayim-nekudotayim">parent</link> и
    <link linkend="language.oop5.late-static-bindings">static</link>
    обрабатывались с учётом регистра. Эта проблема была
    исправлена, и теперь эти слова всегда обрабатываются
    регистронезависимо:
    <literal>SELF::CONSTANT</literal> теперь всегда идентично
    <literal>self::CONSTANT</literal>.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.incompatible.guid">
   <title>Удалены GUID логотипов PHP</title>
   
   <para>
    GUID (внутренние идентификаторы изображения),
    использовавшиеся ранее для вывода различных логотипов
    PHP, теперь удалены. Также удалены функции, которые
    позволяли их получать.
    Удалённые функции:
   </para>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>php_logo_guid</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>php_egg_logo_guid</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>php_real_logo_guid</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>zend_logo_guid</function>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.incompatible.execution">
   <title>Изменения внутреннего исполнения</title>
   
   <para>
    Авторы расширений должны обратить внимание, что
    функция <command>zend_execute()</command>
    больше не может быть переопределена, и что некоторое
    количество изменений внесено в структуру
    <literal>execute_data</literal> и в работающие с ней
    функции и методы обработки байт-кода.
   </para>
   
   <para>
    Большинство авторов расширений вряд ли будут затронуты,
    но те, кто пишет расширения, сильно затрагивающие
    движок Zend, должны ознакомиться с
    <link linkend="migration55.internals">замечаниями по этому изменению</link>.
   </para>
  </sect2>
 </sect1>
 
 <sect1 xml:id="migration55.new-features">
  <title>Новые возможности</title>
  
  <sect2 xml:id="migration55.new-features.generators">
   <title>Добавлены <link linkend="language.generators">генераторы</link></title>
   
   <para>
    Была добавлена поддержка <link linkend="language.generators">генераторов</link>
    через ключевое слово <command>yield</command>.
    Генераторы предоставляют простое решение для реализации
    простых итераторов без накладных расходов или сложности
    создания полноценного класса, реализующего интерфейс
    <classname>Iterator</classname>.
   </para>
   
   <para>
    Простой пример реализации итератора из функции
    <function>range</function> (по крайней мере, для 
    положительных значений <literal>step</literal>):
   </para>
   
   <informalexample>
    <programlisting role="php">
<![CDATA[
<?php
function xrange($start, $limit, $step = 1) {
    for ($i = $start; $i <= $limit; $i += $step) {
        yield $i;
    }
}

echo 'Нечётные числа меньше 10: ';

/*
 * Никакого массива создано и возвращено не будет,
 * все сохраняется в памяти.
 */
foreach (xrange(1, 9, 2) as $number) {
    echo "$number ";
}

echo "\n";
?>
]]>
    </programlisting>
    &example.outputs;
    <screen>
<![CDATA[
Нечётные числа меньше 10: 1 3 5 7 9 
]]>
    </screen>
   </informalexample>
  </sect2>
  
  <sect2 xml:id="migration55.new-features.finally">
   <title>Добавлено ключевое слово &finally;</title>
   
   <para>
    Блоки &try;-&catch; теперь поддерживают блок &finally;,
    который будет выполнен в любом случае, было ли выброшено
    исключение или нет.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.new-features.password">
   <title>Новое API хеширования паролей</title>
   
   <para>
    <link linkend="book.password">Новое API хеширования паролей</link>
    позволяет более просто создавать и управлять безопасными
    хешами паролей и базируется на той же библиотеке, что и
    функция <function>crypt</function>. Подробности можно
    узнать в документации к функции
    <function>password_hash</function>.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.new-features.foreach-list">
   <title><link linkend="control-structures.foreach"><literal>foreach</literal></link> теперь поддерживает <function>list</function></title>
   
   <para>
    Цикл <link linkend="control-structures.foreach">foreach</link>
    теперь поддерживает распаковку вложенных массивов
    в отдельные переменные с помощью конструкции
    <function>list</function>. К примеру:
   </para>
   
   <informalexample>
    <programlisting role="php">
<![CDATA[
<?php
$array = [
    [1, 2],
    [3, 4],
];

foreach ($array as list($a, $b)) {
    echo "A: $a; B: $b\n";
}
?>
]]>
    </programlisting>
    &example.outputs;
    <screen>
<![CDATA[
A: 1; B: 2
A: 3; B: 4
]]>
    </screen>
   </informalexample>
   
   <para>
    Более подробно это нововведение описано на странице
    посвящённой 
    <link linkend="control-structures.foreach.list">foreach</link>.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.new-features.empty">
   <title><function>empty</function> поддерживает произвольные выражения</title>
   
   <para>
    Реализована возможность передавать произвольные 
    выражения в <function>empty</function>. Пример:
   </para>
   
   <informalexample>
    <programlisting role="php">
<![CDATA[
<?php
function always_false() {
    return false;
}

if (empty(always_false())) {
    echo "Это будет напечатано.\n";
}

if (empty(true)) {
    echo "Это не будет напечатано.\n";
}
?>
]]>
    </programlisting>
    &example.outputs;
    <screen>
<![CDATA[
Это будет напечатано.
]]>
    </screen>
   </informalexample>
  </sect2>
  
  <sect2 xml:id="migration55.new-features.const-dereferencing">
   <title>Литералы <type>array</type> и <type>string</type> разыменовываются</title>
   
   <para>
    Литералы <type>array</type> и <type>string</type> теперь
    могут быть разыменованы напрямую для доступа к
    конкретным элементам и символам:
    <informalexample>
     <programlisting role="php">
<![CDATA[
<?php
echo 'Разыменовывание массива: ';
echo [1, 2, 3][0];
echo "\n";

echo 'Разыменовывание строки: ';
echo 'PHP'[0];
echo "\n";
?>
]]>
     </programlisting>
     &example.outputs;
     <screen>
<![CDATA[
Разыменовывание массива: 1
Разыменовывание строки: P
]]>
     </screen>
    </informalexample>
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.new-features.class-name">
   <title>Разрешение имён класса с помощью <link linkend="language.oop5.basic.class.class">::class</link></title>
   
   <para>
    Теперь можно использовать конструкцию
    <literal>ClassName::class</literal> для получения полностью
    определённого имени класса <literal>ClassName</literal>. 
    К примеру:
    
    <informalexample>
     <programlisting role="php">
<![CDATA[
<?php
namespace Name\Space;
class ClassName {}

echo ClassName::class;

echo "\n";
?>
]]>
     </programlisting>
     &example.outputs;
     <screen>
<![CDATA[
Name\Space\ClassName
]]>
     </screen>
    </informalexample>
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.new-features.opcache">
   <title>Добавлено расширение <link linkend="book.opcache">OPcache</link></title>
   
   <para>
    Был добавлен кеш байт-кода Zend Optimiser+ в 
    новом расширении
    <link linkend="book.opcache">OPcache</link>.
    OPcache увеличивает производительность PHP путём
    кеширования предварителльно скомпилированного байт-код скрипта в
    разделяемой памяти, что позволяет избежать загрузки и
    компиляции одних и тех же скриптов при каждом к ним
    обращении. Читайте <link linkend="opcache.installation">инструкции по установке</link>
    для более полной информации об установке и использовании OPcache.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.new-features.non-scalar-iterator-keys">
   <title><link linkend="control-structures.foreach"><literal>foreach</literal></link> теперь поддерживает нескалярные ключи</title>
   
   <para>
    <link linkend="control-structures.foreach">foreach</link> 
    теперь поддерживает ключи любого типа. Так как не
    скалярные ключи не могут возникнуть в обычном массиве, 
    эту функциональность можно использовать с методом
    <methodname>Iterator::key</methodname>, который может 
    вернуть значение любого типа. Теперь эти значения будут
    обрабатываться корректно.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.new-features.windows-apache">
   <title>Поддержка обработчика Apache 2.4 под Windows</title>
   
   <para>
    SAPI обработчик Apache 2.4 теперь поддерживается в Windows.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.new-features.gd">
   <title>Улучшения в GD</title>
   
   <para>
    Несколько улучшений добавлено в расширение GD:
   </para>
   
   <itemizedlist>
    <listitem>
     <simpara>
      Поддержка зеркального отражения с помощью новой
      функции <function>imageflip</function>.
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      Продвинутые возможности обрезки с помощью новых 
      функций <function>imagecrop</function> и 
      <function>imagecropauto</function>.
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
 </sect1>
 
 <sect1 xml:id="migration55.deprecated">
  <title>Функционал, объявленный устаревшим в PHP 5.5.x</title>
  
  <sect2 xml:id="migration55.deprecated.mysql">
   <title>Расширение <link linkend="book.mysql">ext/mysql</link> признано устаревшим</title>
   
   <para>
    <link linkend="book.mysql">Оригинальное расширение MySQL</link> признано устаревшим и будет выдавать ошибку
    уровня <constant>E_DEPRECATED</constant> при 
    установлении соединения с базой данных. Вместо него
    используйте расширения 
    <link linkend="book.mysqli">MySQLi</link> или
    <link linkend="ref.pdo-mysql">PDO_MySQL</link>.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.deprecated.preg-replace-e">
   <title><function>preg_replace</function>, модификатор <literal>/e</literal></title>
   
   <para>
    Использование в функции <function>preg_replace</function>
    модификатора <literal>/e</literal> объявлено устаревшим.
    В качестве альтернативы используйте функцию
    <function>preg_replace_callback</function>.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.deprecated.intl">
   <title><link linkend="book.intl">intl</link></title>
   
   <para>
    <methodname>IntlDateFormatter::setTimeZoneID</methodname> и
    <function>datefmt_set_timezone_id</function> признаны
    устаревшими. Используйте метод <methodname>IntlDateFormatter::setTimeZone</methodname> 
    и функцию <function>datefmt_set_timezone</function>, соответственно.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.deprecated.mcrypt">
   <title><link linkend="book.mcrypt">mcrypt</link></title>
   
   <simpara>
    Следующие функции признаны устаревшими:
   </simpara>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>mcrypt_cbc</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>mcrypt_cfb</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>mcrypt_ecb</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>mcrypt_ofb</function>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
 </sect1>
 
 <sect1 xml:id="migration55.changed-functions">
  <title>Изменённые функции</title>
  
  <sect2 xml:id="migration55.changed-functions.core">
   <title>Ядро PHP</title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>set_error_handler</function> теперь может быть 
      вызвана с параметром &null;, что сбросит установленные
      ранее обработчики.
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      Если вызвать <function>set_error_handler</function> и
      <function>set_exception_handler</function> с параметром 
      &null;, они вернут последний обработчик ошибки или
      исключения соответственно.
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>json_encode</function> теперь принимает
      параметр <parameter>depth</parameter>.
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      Поведение <function>pack</function> и
      <function>unpack</function> с кодами формата "a" и "A"
      изменено.
      <link linkend="migration55.incompatible.pack">Детальное описание данного изменения.</link>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.changed-functions.intl">
   <title><link linkend="book.intl">intl</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <methodname>MessageFormatter::format</methodname> 
      и сопутствующие функции теперь принимают именованные
      аргументы и смешанные числовые и именованные 
      аргументы, когда PHP слинкован с ICU 4.8 или выше.
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <methodname>MessageFormatter::format</methodname>
      и сопутствующие функции больше не генерируют ошибку,
      если передано недостаточное количество аргументов.
      Вместо этого, поля для замещения не будут заменены.
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <methodname>MessageFormatter::format</methodname> и
      <methodname>MessageFormatter::parse</methodname> 
      больше не ограничены в точности секундами, когда
      имеют дело со временем.
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <methodname>IntlDateFormatter::__construct</methodname> и
      <function>datefmt_create</function> теперь принимают
      объекты <classname>IntlTimeZone</classname> и
      <classname>DateTimeZone</classname> для аргумента
      <parameter>timezone</parameter>, и объекты
      <classname>IntlCalendar</classname> для аргумента
      <parameter>calendar</parameter>. Более того, если
      временная зона не задана и не указана в
      <parameter>calendar</parameter>, в качестве временной 
      зоны ICU по умолчанию будет использовано значение
      <function>date_default_timezone_get</function>.
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <methodname>IntlDateFormatter::getCalendar</methodname> и
      <function>datefmt_get_calendar</function> возвращают
      &false; если объект
      <classname>IntlDateFormatter</classname> был создан 
      с помощью <classname>IntlCalendar</classname>, вместо
      использования одной из констант
      <classname>IntlDateFormatter</classname>.
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <methodname>IntlDateFormatter::setCalendar</methodname> и
      <function>datefmt_set_calendar</function> теперь 
      принимают объекты
      <classname>IntlCalendar</classname> в дополнение к
      константам <classname>IntlDateFormatter</classname>.
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <methodname>IntlDateFormatter::format</methodname> и
      <function>datefmt_format</function> теперь принимают
      объекты <classname>IntlCalendar</classname>.
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
 </sect1>
 
 <sect1 xml:id="migration55.new-functions">
  <title>Новые функции</title>
  
  <sect2 xml:id="migration55.new-functions.core">
   <title>Ядро PHP</title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>array_column</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>boolval</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>json_last_error_msg</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>password_get_info</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>password_hash</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>password_needs_rehash</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>password_verify</function>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.new-functions.hash">
   <title><link linkend="book.hash">Hash</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>hash_pbkdf2</function>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.new-functions.openssl">
   <title><link linkend="book.openssl">OpenSSL</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>openssl_pbkdf2</function>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.new-functions.curl">
   <title><link linkend="book.curl">cURL</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>curl_escape</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>curl_file_create</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>curl_multi_setopt</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>curl_multi_strerror</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>curl_pause</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>curl_reset</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>curl_share_close</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>curl_share_init</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>curl_share_setopt</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>curl_strerror</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>curl_unescape</function>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.new-functions.gd">
   <title><link linkend="book.image">GD</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>imageaffinematrixconcat</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>imageaffinematrixget</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>imagecrop</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>imagecropauto</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>imageflip</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>imagepalettetotruecolor</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>imagescale</function>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.new-functions.mysqli">
   <title><link linkend="book.mysqli">MySQLi</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>mysqli_begin_transaction</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>mysqli_release_savepoint</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>mysqli_savepoint</function>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.new-functions.pgsql">
   <title><link linkend="book.pgsql">PostgreSQL</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>pg_escape_literal</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>pg_escape_identifier</function>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.new-functions.sockets">
   <title><link linkend="book.sockets">Sockets</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>socket_sendmsg</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>socket_recvmsg</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>socket_cmsg_space</function>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>  
  
  <sect2 xml:id="migration55.new-functions.cli">
   <title><link linkend="features.commandline">CLI</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>cli_get_process_title</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>cli_set_process_title</function>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.new-functions.intl">
   <title><link linkend="book.intl">Intl</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <function>datefmt_format_object</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>datefmt_get_calendar_object</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>datefmt_get_timezone</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>datefmt_set_timezone</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>datefmt_get_calendar_object</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_create_instance</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_keyword_values_for_locale</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_now</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_available_locales</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_time</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_set_time</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_add</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_set_time_zone</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_after</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_before</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_set</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_roll</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_clear</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_field_difference</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_actual_maximum</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_actual_minimum</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_day_of_week_type</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_first_day_of_week</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_greatest_minimum</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_least_maximum</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_locale</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_maximum</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_minimal_days_in_first_week</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_minimum</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_time_zone</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_type</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_weekend_transition</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_in_daylight_time</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_is_equivalent_to</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_is_lenient</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_is_set</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_is_weekend</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_set_first_day_of_week</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_set_lenient</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_equals</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_repeated_wall_time_option</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_skipped_wall_time_option</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_set_repeated_wall_time_option</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_set_skipped_wall_time_option</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_from_date_time</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_to_date_time</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_error_code</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlcal_get_error_message</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlgregcal_create_instance</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlgregcal_set_gregorian_change</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlgregcal_get_gregorian_change</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intlgregcal_is_leap_year</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_create_time_zone</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_create_default</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_get_id</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_get_gmt</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_get_unknown</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_create_enumeration</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_count_equivalent_ids</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_create_time_zone_id_enumeration</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_get_canonical_id</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_get_region</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_get_tz_data_version</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_get_equivalent_id</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_use_daylight_time</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_get_offset</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_get_raw_offset</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_has_same_rules</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_get_display_name</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_get_dst_savings</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_from_date_time_zone</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_to_date_time_zone</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_get_error_code</function>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <function>intltz_get_error_message</function>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.new-features.spl">
   <title><link linkend="book.spl">SPL</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <methodname>SplFixedArray::__wakeup</methodname>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
 </sect1>
 
 <sect1 xml:id="migration55.classes">
  <title>Новые классы и интерфейсы</title>
  
  <sect2 xml:id="migration55.classes.curl">
   <title><link linkend="book.curl">cURL</link></title>
   <itemizedlist>
    <listitem>
     <simpara>
      <classname>CURLFile</classname>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.classes.datetime">
   <title><link linkend="book.datetime">Дата и время</link></title>
   <itemizedlist>
    <listitem>
     <simpara>
      <classname>DateTimeImmutable</classname>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <classname>DateTimeInterface</classname>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.classes.intl">
   <title><link linkend="book.intl">Intl</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <classname>IntlCalendar</classname>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <classname>IntlGregorianCalendar</classname>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <classname>IntlTimeZone</classname>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <classname>IntlBreakIterator</classname>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <classname>IntlRuleBasedBreakIterator</classname>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <classname>IntlCodePointBreakIterator</classname>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
 </sect1>
 
 <sect1 xml:id="migration55.new-methods">
  <title>Новые методы</title>
  
  <sect2 xml:id="migration55.new-methods.mysqli">
   <title><link linkend="book.mysqli">MySQLi</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <methodname>mysqli::begin_transaction</methodname>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <methodname>mysqli::release_savepoint</methodname>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <methodname>mysqli::savepoint</methodname>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.new-methods.intl">
   <title><link linkend="book.intl">Intl</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <methodname>IntlDateFormatter::formatObject</methodname>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <methodname>IntlDateFormatter::getCalendarObject</methodname>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <methodname>IntlDateFormatter::getTimeZone</methodname>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <methodname>IntlDateFormatter::setTimeZone</methodname>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
 </sect1>
 
 <sect1 xml:id="migration55.extensions-other">
  <title>Прочие изменения в расширениях</title>
  
  <sect2 xml:id="migration55.extensions-other.intl">
   <title><link linkend="book.intl">Intl</link></title>
   
   <para>
    Расширение <link linkend="book.intl">intl</link> требует
    ICU 4.0 или выше.
   </para>
  </sect2>
 </sect1>
 
 <sect1 xml:id="migration55.global-constants">
  <title>Новые глобальные константы</title>
  
  <sect2 xml:id="migration55.global-constants.gd">
   <title><link linkend="book.image">GD</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <constant>IMG_AFFINE_TRANSLATE</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_AFFINE_SCALE</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_AFFINE_ROTATE</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_AFFINE_SHEAR_HORIZONTAL</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_AFFINE_SHEAR_VERTICAL</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_CROP_DEFAULT</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_CROP_TRANSPARENT</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_CROP_BLACK</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_CROP_WHITE</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_CROP_SIDES</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_FLIP_BOTH</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_FLIP_HORIZONTAL</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_FLIP_VERTICAL</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_BELL</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_BESSEL</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_BICUBIC</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_BICUBIC_FIXED</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_BLACKMAN</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_BOX</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_BSPLINE</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_CATMULLROM</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_GAUSSIAN</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_GENERALIZED_CUBIC</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_HERMITE</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_HAMMING</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_HANNING</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_MITCHELL</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_POWER</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_QUADRATIC</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_SINC</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_NEAREST_NEIGHBOUR</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_WEIGHTED4</constant>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <constant>IMG_TRIANGLE</constant>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.global-constants.json">
   <title><link linkend="book.json">JSON</link></title>
   
   <itemizedlist>
    <listitem>
     <simpara>
      <link linkend="constant.json-error-recursion"><constant>JSON_ERROR_RECURSION</constant></link>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <link linkend="constant.json-error-inf-or-nan"><constant>JSON_ERROR_INF_OR_NAN</constant></link>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <link linkend="constant.json-error-unsupported-type"><constant>JSON_ERROR_UNSUPPORTED_TYPE</constant></link>
     </simpara>
    </listitem>
    <listitem>
     <simpara>
      <link linkend="constant.json-partial-output-on-error"><constant>JSON_PARTIAL_OUTPUT_ON_ERROR</constant></link>
     </simpara>
    </listitem>
   </itemizedlist>
  </sect2>
  
  <sect2 xml:id="migration55.global-constants.mysqli">
   <title><link linkend="book.mysqli">MySQLi</link></title>
   
   <para>
    Была добавлена опция
    <constant>MYSQLI_SERVER_PUBLIC_KEY</constant> для
    использования с <function>mysqli_options</function>.
   </para>
  </sect2>
 </sect1>
 
 <sect1 xml:id="migration55.ini">
  <title>Изменения в обработке INI-файла</title>
  
  <sect2 xml:id="migrations55.ini.intl">
   <title><link linkend="book.intl">Intl</link></title>
   
   <para>
    Добавлена директива <literal>intl.use_exceptions</literal>,
    которая контролирует поведение intl в случае 
    возникновения глобальной ошибки. Используется вместе с 
    директивой <literal>intl.error_level</literal>.
   </para>
  </sect2>
  
  <sect2 xml:id="migration55.ini.mysqlnd">
   <title><link linkend="book.mysqlnd">MySQLnd</link></title>
   
   <para>
    Добавлена директива <link linkend="ini.mysqlnd.sha256-server-public-key">mysqlnd.sha256_server_public_key</link>
    для разрешения <link linkend="book.mysqli">mysqli</link>
    использовать новый протокол аутентификации.
   </para>
  </sect2>
 </sect1>
 
 <sect1 xml:id="migration55.internals">
  <title>Внутренние изменения PHP</title>
  
  <itemizedlist>
   <listitem>
    <simpara>
     Расширения больше не могут переопределять
     <command>zend_execute()</command>, вместо этого они
     должны переопределять <command>zend_execute_ex()</command>.
     <literal>EG(current_execute_data)</literal> уже 
     инициализированна в <command>zend_execute_ex()</command>, 
     поэтому, для совместимости расширений, возможно,
     придётся использовать <literal>EG(current_execute_data)-&gt;prev_execute_data</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Удалены <literal>EG(arg_types_stack)</literal>,
     <literal>EX(fbc)</literal>, <literal>EX(called_scope)</literal> 
     и <literal>EX(current_object)</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Добавлен <literal>op_array-&gt;nested_calls</literal>,
     который вычисляется в момент компиляции.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Добавлен <literal>EX(call_slots)</literal>, являющийся 
     массивом для хранения информации о синтаксически
     вложенных вызовах (т.е. <literal>foo(bar())</literal>) и 
     размещающийся вместе с <literal>execute_data</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Добавлен <literal>EX(call)</literal>, являющийся 
     указателем на вызываемую функцию, и являющийся 
     элементом <literal>EX(call_slots)</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Байткоды
     <link linkend="internals2.opcodes.init-method-call">INIT_METHOD_CALL</link>,
     <link linkend="internals2.opcodes.init-static-method-call">ZEND_INIT_STATIC_METHOD_CALL</link>,
     <link linkend="internals2.opcodes.init-fcall-by-name">ZEND_INIT_FCALL_BY_NAME</link>
     и
     <link linkend="internals2.opcodes.init-ns-fcall-by-name">ZEND_INIT_NS_FCALL_BY_NAME</link>
     используют <literal>result.num</literal> как индекс в
     <literal>EX(call_slots)</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Байткод <link linkend="internals2.opcodes.new">ZEND_NEW</link> использует
     <literal>extended_value</literal> как индекс в
     <literal>EX(call_slots)</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Байткоды <link linkend="internals2.opcodes.do-fcall">ZEND_DO_FCALL</link>
     и
     <link linkend="internals2.opcodes.do-fcall-by-name">ZEND_DO_FCALL_BY_NAME</link>
     используют <literal>op2.num</literal> как индекс в
     <literal>EX(call_slots)</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Добавлен <literal>op_array-&gt;used_stack</literal>, 
     вычисляемый в момент компиляции; соответствующее место под стек
     выделяется совместно с <literal>execute_data</literal>. В
     результате, байткоды ZEND_SEND* и ZEND_DO_FCALL*
     больше не требуют проверки на переполнение стека.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Удалено поле <literal>execute_data-&gt;Ts</literal>. 
     Временные переменные VM всегда размещаются
     сразу перед структурой <literal>execute_data</literal>,
     и теперь более предпочтительно обращаться к ним по
     смещению от базового указателя 
     <literal>execute_data</literal> вместо того, чтобы 
     использовать <literal>execute_data-&gt;Ts</literal>.  
     Компилятор хранит новые смещения в 
     <literal>op_array-&gt;opcodes[*].op?.num</literal>.  
     Макросы <command>EX_TMP_VAR()</command> и
     <command>EX_TMP_VAR_NUM()</command>
     могут быть использованы для доступа к временным
     переменным по смещению или номеру. Вы можете
     преобразовать номер в смещение используя
     <command>EX_TMP_VAR_NUM(0, num)</command> или
     смещение в номер используя
     <command>(EX_TMP_VAR_NUM(0,0)-EX_TMP_VAR(0,offset))</command>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Удалено поле <literal>execute_data-&gt;CVs</literal>. 
     Скомпилированные переменные VM всегда размещаются
     сразу после структуры <literal>execute_data</literal>, и
     получать к ним доступ следует по смещению от базового 
     указателя <literal>execute_data</literal> вместо того,
     чтобы использовать <literal>execute_data-&gt;CVs</literal>.
     Вы можете использовать макрос
     <command>EX_CV_NUM()</command> для доступа к
     скомпилированным переменным по номеру.
    </simpara>
   </listitem>
  </itemizedlist>
 </sect1>
</appendix>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
